<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Vyapar Drishti Invoice</title>
    <style>
        * {
            box-sizing: border-box !important;
        }

        body {
            padding: 0 !important;
            margin: 0 !important;
            font-family: Arial, sans-serif !important;
            font-size: 11px;

        }

        @media print {
            body {
                margin: 0 !important;
                padding: 0 !important;
            }

            .no-print {
                display: none !important;
            }
        }

        table.items-table {
            width: 100% !important;
            border-collapse: collapse !important;
            font-size: 10px !important;
            page-break-inside: auto;
        }

        .items-table tr {
            page-break-inside: avoid;
            page-break-after: auto;
        }

        .items-table th,
        .items-table td {
            border: 1px solid #000 !important;
            padding: 4px !important;
        }

        /* Totals section should never split across pages */
        .totals-section {
            page-break-inside: avoid;
            margin-top: 5mm;
        }
    </style>
</head>

<body>
    {# ---------------- HEADER SECTION ---------------- #}
    {% macro invoice_header() %}
    <table style="width: 190mm !important;
            max-height: 85mm !important;
            vertical-align: top !important;
            margin: 0mm auto !important;
            border-left: 1px solid #000 !important;
            border-right: 1px solid #000 !important;
            border-top: 1px solid #000 !important;
            border-collapse: collapse !important;" cellpadding="0" cellspacing="0">
        <tr>
            <td>
                <table style="width: 100% !important; border-collapse: collapse;" cellpadding="0" cellspacing="0">
                    <!-- Company Details -->
                    <tr style="border-bottom: 1px solid #000 !important;">
                        <td colspan="2" style=" padding: 2mm !important;">
                            <!-- Company Details -->
                            {% if invoice.voucher_type == 'Sales' %}
                            <table
                                style="text-align: center !important; width: 100% !important; border-collapse: collapse;"
                                cellpadding="1" cellspacing="0">
                                <tr>
                                    <td style="font-size: 18px !important; 
                                        font-weight: bold !important; 
                                        margin-bottom: 2mm !important;">
                                        {{ company.company_name
                                        }}
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        {% if company.address_1 %}
                                        {{
                                        company.address_1
                                        }}
                                        {% if company.address_2 %}
                                        ,&nbsp;{{
                                        company.address_2
                                        }}
                                        {% endif %}
                                        {% else %}
                                        {% if company.address_2 %}
                                        {{
                                        company.address_2
                                        }}
                                        {% endif %}
                                        {% endif %}
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        {% if company.state %}
                                        {{
                                        company.state
                                        }}
                                        {% if company.country %}
                                        ,&nbsp;{{
                                        company.country
                                        }}
                                        {% if company.pincode %}
                                        &nbsp;-&nbsp;{{
                                        company.pincode
                                        }}
                                        {% endif %}
                                        {% else %}
                                        {% if company.pincode %}
                                        &nbsp;-&nbsp;{{
                                        company.pincode
                                        }}
                                        {% endif %}
                                        {% endif %}
                                        {% else %}
                                        {% if company.country %}
                                        {{
                                        company.country
                                        }}
                                        {% if company.pincode %}
                                        &nbsp;-&nbsp;{{
                                        company.pincode
                                        }}
                                        {% endif %}
                                        {% else %}
                                        {% if company.pincode %}
                                        {{
                                        company.pincode
                                        }}
                                        {% endif %}
                                        {% endif %}

                                        {% endif %}
                                    </td>

                                </tr>
                                <tr>
                                    <td>
                                        {% if company.phone.number %}
                                        <strong>Phone
                                            :</strong> {{
                                        company.phone.code
                                        }}&nbsp;{{
                                        company.phone.number }},
                                        {% else %}
                                        &nbsp;
                                        {% endif %}
                                        {% if company.email %}
                                        <strong>Email
                                            :</strong> {{ company.email }}
                                        {% else %}
                                        &nbsp;
                                        {% endif %}
                                    </td>
                                </tr>
                            </table>
                            {% else %}
                            <table
                                style="text-align: center !important; width: 100% !important; border-collapse: collapse;"
                                cellpadding="1" cellspacing="0">
                                <tr>
                                    <td style="font-size: 18px !important; 
                                        font-weight: bold !important; 
                                        margin-bottom: 2mm !important;">
                                        {{ party.name }}
                                    </td>
                                </tr>
                                <tr>
                                    <td>{{ party.address }}</td>
                                </tr>
                                <tr>
                                    <td>
                                        {% if party.mailing_state %}
                                        {{
                                        party.mailing_state
                                        }}
                                        {% if party.mailing_country %}
                                        ,&nbsp;{{
                                        party.mailing_country
                                        }}
                                        {% if party.mailing_pincode %}
                                        &nbsp;-&nbsp;{{
                                        party.mailing_pincode
                                        }}
                                        {% endif %}
                                        {% else %}
                                        {% if party.mailing_pincode %}
                                        &nbsp;-&nbsp;{{
                                        party.mailing_pincode
                                        }}
                                        {% endif %}
                                        {% endif %}
                                        {% else %}
                                        {% if party.mailing_country %}
                                        {{
                                        party.mailing_country
                                        }}
                                        {% if party.mailing_pincode %}
                                        &nbsp;-&nbsp;{{
                                        party.mailing_pincode
                                        }}
                                        {% endif %}
                                        {% else %}
                                        {% if party.mailing_pincode %}
                                        {{
                                        party.mailing_pincode
                                        }}
                                        {% endif %}
                                        {% endif %}

                                        {% endif %}
                                    </td>

                                </tr>
                                <tr>
                                    <td>
                                        {% if party.phone.number %}
                                        <strong>Phone
                                            :</strong> {{
                                        party.phone.code
                                        }}&nbsp;{{
                                        party.phone.number }},
                                        {% else %}
                                        &nbsp;
                                        {% endif %}
                                        {% if party.email %}
                                        <strong>Email
                                            :</strong> {{ party.email }}
                                        {% else %}
                                        &nbsp;
                                        {% endif %}
                                    </td>
                                </tr>
                            </table>
                            {% endif %}
                        </td>
                    </tr>
                    <!-- Invoice and Party Details -->
                    <tr style="border-bottom: 1px solid #000 !important;">
                        <td style="width: 50% !important; padding: 2mm !important;">
                            <!-- Party Details  -->
                            {% if invoice.voucher_type == 'Sales' %}
                            <table
                                style="text-align: left !important; width: 100% !important; border-collapse: collapse; vertical-align: top !important;"
                                cellpadding="1" cellspacing="0">
                                <tr>
                                    <td style="font-weight: bold; padding-bottom: 1mm !important;">{{ party.name }}
                                    </td>
                                </tr>
                                <tr>
                                    <td>{{ party.address }}</td>
                                </tr>
                                <tr>
                                    <td>{% if party.mailing_state %}
                                        {{
                                        party.mailing_state
                                        }}
                                        {% if party.mailing_country %}
                                        ,&nbsp;{{
                                        party.mailing_country
                                        }}
                                        {% if party.mailing_pincode %}
                                        &nbsp;-&nbsp;{{
                                        party.mailing_pincode
                                        }}
                                        {% endif %}
                                        {% else %}
                                        {% if party.mailing_pincode %}
                                        &nbsp;-&nbsp;{{
                                        party.mailing_pincode
                                        }}
                                        {% endif %}
                                        {% endif %}
                                        {% else %}
                                        {% if party.mailing_country %}
                                        {{
                                        party.mailing_country
                                        }}
                                        {% if party.mailing_pincode %}
                                        &nbsp;-&nbsp;{{
                                        party.mailing_pincode
                                        }}
                                        {% endif %}
                                        {% else %}
                                        {% if party.mailing_pincode %}
                                        {{
                                        party.mailing_pincode
                                        }}
                                        {% endif %}
                                        {% endif %}

                                        {% endif %}</td>

                                </tr>
                                <tr>
                                    <td>
                                        {% if party.phone.number %}
                                        <strong>Phone
                                            &nbsp;:&nbsp;</strong>&nbsp;{{
                                        party.phone.code
                                        }}&nbsp;&nbsp;{{
                                        party.phone.number }}
                                        {% else %}
                                        &nbsp;
                                        {% endif %}
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        {% if party.email %}
                                        <strong>Email&nbsp;
                                            :&nbsp;</strong> &nbsp;{{ party.email }}
                                        {% else %}
                                        &nbsp;
                                        {% endif %}
                                    </td>
                                </tr>
                            </table>
                            {% else %}
                            <table>
                                <tr>
                                    <td style="font-weight: bold; padding-bottom: 1mm !important;"> {{
                                        company.company_name }}
                                    </td>
                                </tr>
                                <tr>
                                    <td>{% if company.address_1 %}
                                        {{ company.address_1 }}
                                        {% if company.address_2 %}
                                        ,&nbsp;{{ company.address_2 }}
                                        {% endif %}
                                        {% else %}
                                        {% if company.address_2 %}
                                        {{ company.address_2 }}
                                        {% endif %}
                                        {% endif %}</td>
                                </tr>
                                <tr>
                                    <td>{% if company.state %}
                                        {{ company.state }}
                                        {% if company.country %}
                                        ,&nbsp;{{ company.country }}
                                        {% if company.pincode %}
                                        &nbsp;-&nbsp;{{ company.pincode }}
                                        {% endif %}
                                        {% else %}
                                        {% if company.pincode %}
                                        &nbsp;-&nbsp;{{ company.pincode }}
                                        {% endif %}
                                        {% endif %}
                                        {% else %}
                                        {% if company.country %}
                                        {{ company.country }}
                                        {% if company.pincode %}
                                        &nbsp;-&nbsp;{{ company.pincode }}
                                        {% endif %}
                                        {% else %}
                                        {% if company.pincode %}
                                        {{ company.pincode }}
                                        {% endif %}
                                        {% endif %}

                                        {% endif %}</td>

                                </tr>
                                <tr>
                                    <td>{% if company.phone.number %}
                                        <strong>Phone&nbsp;:&nbsp;</strong>
                                        &nbsp;{{ company.phone.code }}
                                        &nbsp;&nbsp;{{ company.phone.number }}
                                        {% else %}
                                        &nbsp;
                                        {% endif %}
                                    </td>
                                </tr>
                                <tr>
                                    <td>{% if company.email %}
                                        <strong>Email&nbsp;
                                            :&nbsp;</strong> &nbsp;{{ company.email }}
                                        {% else %}
                                        &nbsp;
                                        {% endif %}
                                    </td>
                                </tr>
                            </table>
                            {% endif %}
                        </td>

                        <!-- Invoice Details -->
                        <td
                            style="width: 50% !important; border-left: 1px solid #000 !important; padding: 2mm !important;">
                            <!-- Invoice Details -->
                            <table
                                style="text-align: left !important; width: 100% !important; border-collapse: collapse;"
                                cellpadding="1" cellspacing="0">
                                <tr>
                                    <td style="width: 60% !important;">
                                        <strong>
                                            Invoice No
                                        </strong>
                                    </td>
                                    <td>
                                        :
                                    </td>
                                    <td style="width: 30% !important;">
                                        {{ invoice.voucher_number }}
                                    </td>
                                </tr>
                                <tr>
                                    <td style="width: 60% !important;">
                                        <strong>
                                            Invoice Date
                                        </strong>
                                    </td>
                                    <td>
                                        :
                                    </td>
                                    <td style="width: 30% !important;">
                                        {{ invoice.date }}
                                    </td>
                                </tr>
                                <tr>
                                    <td style="width: 60% !important;">
                                        <strong>
                                            Place of Supply
                                        </strong>
                                    </td>
                                    <td>
                                        :
                                    </td>
                                    <td style="width: 30% !important;">
                                        {{ invoice.place_of_supply }}
                                    </td>
                                </tr>
                                <tr>
                                    <td style="width: 60% !important;">
                                        <strong>
                                            Mode of Transport
                                        </strong>
                                    </td>
                                    <td>
                                        :
                                    </td>
                                    <td style="width: 30% !important;">
                                        {{ invoice.mode_of_transport }}
                                    </td>
                                </tr>
                                <tr>
                                    <td style="width: 60% !important;">
                                        <strong>
                                            Vehicle No
                                        </strong>
                                    </td>
                                    <td>
                                        :
                                    </td>
                                    <td style="width: 30% !important;">
                                        {{ invoice.vehicle_number }}
                                    </td>
                                </tr>
                                <tr>
                                    <td style="width: 60% !important;">
                                        <strong>
                                            Payment Mode
                                        </strong>
                                    </td>
                                    <td>
                                        :
                                    </td>
                                    <td style="width: 30% !important;">
                                        {{ invoice.payment_mode }}
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>

                    <!-- Invoice Header -->
                    <tr style="border-bottom: 1px solid #000 !important;">
                        <td colspan="2"
                            style="text-align: center; padding: 8px; background-color: #f2f2f2;  font-size: 16px; font-weight: bold;">
                            {{invoice.voucher_type}}&nbsp;Invoice
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
    {% endmacro %}



    {# ---------------- ITEMS TABLE ---------------- #}
    {% macro items_table(items, offset=0) %}
    <table style="width: 190mm !important;
            vertical-align: top !important;
            margin: 0mm auto !important;
            border-bottom: 1px solid #000 !important;
            border-left: 1px solid #000 !important;
            border-right: 1px solid #000 !important;
            border-collapse: collapse !important;" cellpadding="0" cellspacing="0">
        <!-- Product Details Table -->
        <tr>
            <td style="padding: 1mm !important; padding-top: 2mm !important;">
                <table class="items-table" style="width: 100% !important; text-wrap: nowrap; white-space: nowrap; border-collapse: collapse
                    !important; border-top: 1px solid #000 !important; font-size: 10px !important; " cellpadding="4"
                    cellspacing="0">
                    <tr
                        style="width: 100% !important;  background-color: #f2f2f2 !important; height: 5mm !important;  font-weight: bold !important;">
                        <th
                            style="border-bottom: 1px solid #000 !important; border-right: 1px solid #000 !important; text-align: center;">
                            SN</th>
                        <th
                            style="border-bottom: 1px solid #000 !important; border-right: 1px solid #000 !important; text-align: left; padding-left: 1mm !important;">
                            Description of Goods</th>
                        <th
                            style="border-bottom: 1px solid #000 !important; border-right: 1px solid #000 !important; text-align: center;">
                            Qty.</th>
                        <th
                            style="border-bottom: 1px solid #000 !important; border-right: 1px solid #000 !important; text-align: center;">
                            Units</th>
                        <th
                            style="border-bottom: 1px solid #000 !important; border-right: 1px solid #000 !important; text-align: center;">
                            RATE</th>
                        <th
                            style="border-bottom: 1px solid #000 !important; border-right: 1px solid #000 !important; text-align: center;">
                            Price</th>
                        <th
                            style="border-bottom: 1px solid #000 !important; border-right: 1px solid #000 !important; text-align: center;">
                            Disc.</th>
                        <th style="border-bottom: 1px solid #000 !important; text-align: center;">
                            Amount</th>
                    </tr>
                    {% for item in items %}
                    <tr {% if loop.index0 % 2==1 %}style="background-color: #f9f9f9;" {% endif %}>
                        <td
                            style="border-bottom: 1px solid #000 !important; border-right: 1px solid #000 !important; text-align: center;">
                            {{ offset + loop.index }}
                        </td>
                        <td
                            style="border-bottom: 1px solid #000 !important; border-right: 1px solid #000 !important; text-align: left; padding-left: 1mm !important;">
                            {{ item.name }}
                        </td>
                        <td
                            style="border-bottom: 1px solid #000 !important; border-right: 1px solid #000 !important; text-align: center;">
                            {{ item.qty }}
                        </td>
                        <td
                            style="border-bottom: 1px solid #000 !important; border-right: 1px solid #000 !important; text-align: center;">
                            {{ item.pack }}
                        </td>
                        <td
                            style="border-bottom: 1px solid #000 !important; border-right: 1px solid #000 !important; text-align: center;">
                            {{ item.rate|float|round(2) }}
                        </td>
                        <td
                            style="border-bottom: 1px solid #000 !important; border-right: 1px solid #000 !important;  text-align: center;">
                            {{ item.amount|float|round(2) }}
                        </td>
                        <td
                            style="border-bottom: 1px solid #000 !important; border-right: 1px solid #000 !important;  text-align: center;">
                            {{ item.discount_amount|float|round(2) }}
                        </td>

                        <td style="border-bottom: 1px solid #000 !important; text-align: center; font-weight: bold;">
                            {{ item.total_amount|float|round(2) }}
                        </td>
                    </tr>
                    {% endfor %}

                </table>
            </td>
        </tr>
    </table>
    {% endmacro %}


    {# ---------------- TOTALS SECTION ---------------- #}
    {% macro totals_section(last_page=False) %}
    <table style="width: 190mm !important;
            height: 40mm !important;
            vertical-align: top !important;
            margin: 0mm auto !important;
            padding-top: 2mm !important;
            border-left: 1px solid #000 !important;
            border-right: 1px solid #000 !important;
            border-collapse: collapse !important;" cellpadding="0" cellspacing="0">
        <!-- Totals Section -->
        <tr>
            <td class="totals-section">
                <table style="width: 100% !important; padding: 2mm !important;" cellpadding="0" cellspacing="0">
                    <tr>
                        <td style="vertical-align: top !important; ">
                            <table
                                style="width: 120mm !important; border-collapse: collapse !important; border: 1px solid #000 !important; background-color: #f2f2f2 !important;"
                                cellpadding="0" cellspacing="0">
                                <tr style="height: 10mm !important;">
                                    <td
                                        style="border: 1px solid #000 !important; font-size: 12px !important; text-align: center !important; font-weight: bold !important;">
                                        {{ invoice.grand_total_words }}
                                    </td>
                                </tr>
                            </table>

                            {% if invoice.voucher_type == 'Sales' %}
                            <table
                                style="width: 120mm !important; height: 15mm !important; border-collapse: collapse !important;"
                                cellpadding="0" cellspacing="0">
                                <tr>
                                    <td
                                        style="padding-left: 2mm !important; padding-top: 2mm !important; font-size: 12px !important; font-weight: bold; margin-bottom: 1mm !important;">
                                        Terms & Conditions :
                                    </td>
                                </tr>
                                <tr>
                                    <td style="font-size: 10px !important; padding-left: 2mm !important;">
                                        Thanks for doing business with us.
                                    </td>
                                </tr>
                                <tr>
                                    <td style="font-size: 10px !important; padding-left: 2mm !important;">
                                        Interest @ 18% percent interest will be charged extra on payments due
                                        after 7 days from the date
                                        of billing.
                                    </td>
                                </tr>
                                <tr>
                                    <td style="font-size: 10px !important; padding-left: 2mm !important;">
                                        No replacement of broken or damaged goods. Please accept goods in proper
                                        condition only.
                                    </td>
                                </tr>
                                <tr>
                                    <td style="font-size: 10px !important; padding-left: 2mm !important;">
                                        Goods once sold are not returnable.
                                    </td>
                                </tr>
                                <tr>
                                    <td
                                        style="font-size: 10px !important; padding-bottom: 2mm !important; padding-left: 2mm !important;">
                                        All Disputes & claims will be referred to the court at Udaipur
                                        jurisdiction.
                                    </td>
                                </tr>
                            </table>
                            {% endif %}
                        </td>

                        {% if last_page %}
                        <td style="vertical-align: top !important; ">
                            <div style="page-break-inside: avoid;">
                                <table
                                    style="width: 60mm !important; font-size: 10px !important;  border-collapse: collapse;  border: 1px solid #000;"
                                    cellpadding="0" cellspacing="0">
                                    <tr style="height: 5mm !important; border-bottom: 1px solid #000 !important;">
                                        <td style="padding-left: 2mm !important; font-weight: bold;">
                                            SUB TOTAL</td>
                                        <td
                                            style="padding-right: 2mm !important; text-align: right !important; border-left: 1px solid #000 !important;">
                                            {{ invoice.total|float|round(2) }}</td>
                                    </tr>
                                    <tr style="height: 5mm !important; border-bottom: 1px solid #000 !important;">
                                        <td style="padding-left: 2mm !important; font-weight: bold;">
                                            DISCOUNT</td>
                                        <td
                                            style="padding-right: 2mm !important; text-align: right !important; border-left: 1px solid #000 !important;">
                                            {{ invoice.discount|float|round(2) }}</td>
                                    </tr>
                                    <tr style="height: 5mm !important; border-bottom: 1px solid #000 !important;">
                                        <td style="padding-left: 2mm !important; font-weight: bold;">
                                            TOTAL</td>
                                        <td
                                            style="padding-right: 2mm !important; text-align: right !important; border-left: 1px solid #000 !important;">
                                            {{ invoice.total|float|round(2) }}</td>
                                    </tr>
                                    <tr style="height: 5mm !important; border-bottom: 1px solid #000 !important;">
                                        <td style="padding-left: 2mm !important; font-weight: bold;">
                                            Additional Charges</td>
                                        <td
                                            style="padding-right: 2mm !important; text-align: right !important; border-left: 1px solid #000 !important;">
                                            {{ invoice.additional_charge|float|round(2)}}</td>
                                    </tr>
                                    <tr style="height: 5mm !important; border-bottom: 1px solid #000 !important;">
                                        <td style="padding-left: 2mm !important; font-weight: bold;">
                                            Round off</td>
                                        <td
                                            style="padding-right: 2mm !important; text-align: right !important; border-left: 1px solid #000 !important;">
                                            {{ invoice.roundoff}}</td>
                                    </tr>
                                </table>
                                <table
                                    style="width: 60mm !important; border-collapse: collapse !important; border: 1px solid #000 !important; background-color: #f2f2f2 !important; margin-top: 2mm !important;"
                                    cellpadding="0" cellspacing="0">
                                    <tr style="height: 10mm !important;">
                                        <td
                                            style="border: 1px solid #000 !important; font-size: 12px !important; text-align: center !important; font-weight: bold !important;">
                                            GRAND TOTAL: &#8377; {{ invoice.grand_total|float|round(2) }}</td>
                                    </tr>
                                </table>
                            </div>
                        </td>
                        {% endif %}
                    </tr>
                </table>

            </td>
        </tr>
    </table>
    {% endmacro %}


    {# ---------------- FOOTERS SECTION ---------------- #}
    {% macro invoice_footer() %}
    <table style="width: 190mm !important;
            max-height: 20mm !important;
            vertical-align: bottom !important;
            margin: 0mm auto !important;
            border: 1px solid #000 !important;
            border-collapse: collapse !important;" cellpadding="0" cellspacing="0">
        <!-- Signature's Section -->
        <tr>
            <td style="margin-top: 2mm !important; padding-top: 4mm !important;">
                <table style="width: 100% !important; border-collapse: collapse !important;" cellpadding="0"
                    cellspacing="0">
                    <tr>
                        <td
                            style="width: 40% !important; text-align: center !important; vertical-align: top !important;">
                            <div
                                style="border-top: 1px solid #000 !important; width: 200px !important; margin: 0 auto 5px auto !important;">
                            </div>
                            {% if invoice.voucher_type == 'Sales' %}
                            <div style="font-weight: bold !important; font-size: 12px !important;">{{party.name}}
                            </div>
                            {% else %}
                            <div style="font-weight: bold !important; font-size: 12px !important;">
                                {{company.company_name}}
                            </div>
                            {% endif %}
                        </td>
                        <td style="width: 20% !important;">&nbsp;</td>
                        <td
                            style="width: 40% !important; text-align: center !important; vertical-align: top !important;">
                            <div
                                style="border-top: 1px solid #000 !important; width: 200px !important; margin: 0 auto 5px auto !important;">
                            </div>
                            {% if invoice.voucher_type == 'Sales' %}
                            <div style="font-weight: bold !important; font-size: 12px !important;">
                                {{ company.company_name }}
                            </div>
                            {% else %}
                            <div style="font-weight: bold !important; font-size: 12px !important;">
                                {{party.name}}
                            </div>
                            {% endif %}
                        </td>
                    </tr>
                </table>
            </td>
        </tr>

        <!-- Motto -->
        <tr>
            <td
                style="text-align: center !important; padding-bottom: 1mm !important; font-size: 14px !important; font-weight: bold !important; color: #C04000; text-decoration: underline !important;">
                {{ company.motto|default("LIFE'S A JOURNEY, KEEP SMILING") }}
            </td>
        </tr>
        <tr>
            <td
                style="text-align: center !important; padding-bottom: 3mm !important; font-size: 8px !important; text-decoration: underline !important;">
                This {{invoice.voucher_type}}&nbsp;Invoice generated by Vyapar Drishti GST Billing App.
            </td>
        </tr>
    </table>
    {% endmacro %}

    {# ---------------- EMPTY SPACE SECTION ---------------- #}
    {% macro fill_space(height=0, text=' ') %}
    <table style="width: 190mm !important;
            vertical-align: top !important;
            margin: 0mm auto !important;
            border-left: 1px solid #000 !important;
            border-right: 1px solid #000 !important;
            text-align: center !important;
            border-collapse: collapse !important;" cellpadding="0" cellspacing="0">
        <tr>
            <td style="height: {{ ([height, 0] | max) | int }}mm; border: none;">{{text}}</td>
        </tr>
    </table>
    {% endmacro %}


    {# ---------------- PAGE LOGIC ---------------- #}
    {% set total_items = invoice["items"]|length %}
    {% set items_per_page = 30 %}
    {% set row_height = 5 %} {# each row ≈ 5mm #}
    {% set page_body_height = 180 %} {# space between header & footer in mm #}
    {% set totals_height = 40 %} {# space between header & footer in mm #}

    {# ---------- CASE 1: Few items ---------- #}
    {% if total_items <= 25 %} 
        {{ invoice_header() }} 
        {{ items_table(invoice["items"]) }} 
        {% set empty_space=page_body_height - ((invoice["items"]|length * row_height) + totals_height) %} 
        {{ fill_space(empty_space) }} 
        {{ totals_section(last_page=True) }} 
        {{ invoice_footer() }}



    {# ---------- CASE 2: Items 25-30 ---------- #}
    {% elif total_items > 25 and total_items <= 30 %} 
        {# Page 1: items #} 
        {{ invoice_header() }} 
        {{ items_table(invoice["items"]) }} 
        {% set empty_space = page_body_height - (invoice["items"]|length * row_height) %} 
        {{ fill_space(empty_space, text='Continue...' ) }} 
        {{ invoice_footer() }} 
        <div style="page-break-after: always !important;"> </div>

        {# Page 2: totals #}
        {{ invoice_header() }}
        {{ totals_section(last_page=True) }}
        {% set empty_space = page_body_height - totals_height %}
        {{ fill_space(empty_space) }}
        {{ invoice_footer() }}


    {# ---------- CASE 3: Items > 35 ---------- #}
    {% else %}
        {% set page_count = (total_items // items_per_page) + (1 if total_items % items_per_page else 0) %}
        {% for page in range(page_count) %}
            {% set start = page * items_per_page %}
            {% set end = start + items_per_page %}
            {% set page_items = invoice["items"][start:end] %}

            {{ invoice_header() }}
            {{ items_table(page_items, offset=start) }}

            {# If this is the last items page, start totals split #}
            {% if page == page_count - 1 %}
                {{ totals_section(last_page=True) }}
                {% set empty_space = page_body_height - ((page_items|length * row_height) + totals_height ) %}
                {{ fill_space(empty_space) }}
                {{ invoice_footer() }}
            {% else %}
                {% set empty_space = page_body_height - (page_items|length * row_height) %}
                {{ fill_space(empty_space, text='Continue...') }}
                {{ invoice_footer() }}
            {% endif %}

            {% if not loop.last %}
            <div style="page-break-after: always !important;"></div>
            {% endif %}
        {% endfor %}
    {% endif %}



</body>

</html>